\hypertarget{test__binary_8cpp}{}\doxysection{tests/io/test\+\_\+binary.cpp File Reference}
\label{test__binary_8cpp}\index{tests/io/test\_binary.cpp@{tests/io/test\_binary.cpp}}
{\ttfamily \#include \char`\"{}traccc/io/read\+\_\+cells.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/io/read\+\_\+digitization\+\_\+config.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/io/read\+\_\+geometry.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/io/read\+\_\+measurements.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/io/read\+\_\+spacepoints.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/io/utils.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/io/write.\+hpp\char`\"{}}\newline
{\ttfamily \#include $<$vecmem/memory/host\+\_\+memory\+\_\+resource.\+hpp$>$}\newline
{\ttfamily \#include $<$gtest/gtest.\+h$>$}\newline
{\ttfamily \#include $<$cstdio$>$}\newline
{\ttfamily \#include $<$fstream$>$}\newline
Include dependency graph for test\+\_\+binary.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d89/test__binary_8cpp__incl}
\end{center}
\end{figure}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{test__binary_8cpp_a982cdc8114f9e792909e9681e7a4fa56}{T\+E\+ST}} (io\+\_\+binary, cell)
\item 
\mbox{\hyperlink{test__binary_8cpp_a6ebd5d9573fedd50395db6808781e78d}{T\+E\+ST}} (io\+\_\+binary, spacepoint)
\item 
\mbox{\hyperlink{test__binary_8cpp_a61e32821faaecee37b0e249049024982}{T\+E\+ST}} (io\+\_\+binary, measurement)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{test__binary_8cpp_a982cdc8114f9e792909e9681e7a4fa56}\label{test__binary_8cpp_a982cdc8114f9e792909e9681e7a4fa56}} 
\index{test\_binary.cpp@{test\_binary.cpp}!TEST@{TEST}}
\index{TEST@{TEST}!test\_binary.cpp@{test\_binary.cpp}}
\doxysubsubsection{\texorpdfstring{TEST()}{TEST()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily T\+E\+ST (\begin{DoxyParamCaption}\item[{io\+\_\+binary}]{,  }\item[{cell}]{ }\end{DoxyParamCaption})}

T\+R\+A\+C\+CC library, part of the A\+C\+TS project (R\&D line)

(c) 2022 C\+E\+RN for the benefit of the A\+C\+TS project

Mozilla Public License Version 2.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{28                       \{}
\DoxyCodeLine{29 }
\DoxyCodeLine{30     \textcolor{comment}{// Set event configuration}}
\DoxyCodeLine{31     \textcolor{keyword}{const} std::size\_t \textcolor{keyword}{event} = 0;}
\DoxyCodeLine{32     \textcolor{keyword}{const} std::string cells\_directory = \textcolor{stringliteral}{"tml\_full/ttbar\_mu200/"};}
\DoxyCodeLine{33 }
\DoxyCodeLine{34     \textcolor{comment}{// Memory resource used by the EDM.}}
\DoxyCodeLine{35     vecmem::host\_memory\_resource host\_mr;}
\DoxyCodeLine{36 }
\DoxyCodeLine{37     \textcolor{comment}{// Read the surface transforms}}
\DoxyCodeLine{38     \textcolor{keyword}{auto} surface\_transforms =}
\DoxyCodeLine{39         \mbox{\hyperlink{namespacetraccc_1_1io_a5a6c904c086473a05b85a0bf060bfa8d}{traccc::io::read\_geometry}}(\textcolor{stringliteral}{"tml\_detector/trackml-\/detector.csv"});}
\DoxyCodeLine{40 }
\DoxyCodeLine{41     \textcolor{comment}{// Read the digitization configuration file}}
\DoxyCodeLine{42     \textcolor{keyword}{auto} digi\_cfg = \mbox{\hyperlink{namespacetraccc_1_1io_aa6519a2968b73b699f1aee456d80c190}{traccc::io::read\_digitization\_config}}(}
\DoxyCodeLine{43         \textcolor{stringliteral}{"tml\_detector/default-\/geometric-\/config-\/generic.json"});}
\DoxyCodeLine{44 }
\DoxyCodeLine{45     \textcolor{comment}{// Read csv file}}
\DoxyCodeLine{46     \mbox{\hyperlink{structtraccc_1_1io_1_1cell__reader__output}{traccc::io::cell\_reader\_output}} reader\_csv(\&host\_mr);}
\DoxyCodeLine{47     \mbox{\hyperlink{namespacetraccc_1_1io_a4141a99f877738d68d63f85ed5642462}{traccc::io::read\_cells}}(reader\_csv, \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, cells\_directory,}
\DoxyCodeLine{48                            \mbox{\hyperlink{namespacetraccc_af412a9ab8cc2a30a664acd9f62bb83daaad4c20898046609aa6860e412b43c422}{traccc::data\_format::csv}}, \&surface\_transforms,}
\DoxyCodeLine{49                            \&digi\_cfg);}
\DoxyCodeLine{50     \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::cell\_collection\_types::host}}\& cells\_csv = reader\_csv.cells;}
\DoxyCodeLine{51     \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::cell\_module\_collection\_types::host}}\& modules\_csv =}
\DoxyCodeLine{52         reader\_csv.modules;}
\DoxyCodeLine{53 }
\DoxyCodeLine{54     \textcolor{comment}{// Write binary file}}
\DoxyCodeLine{55     \mbox{\hyperlink{namespacetraccc_1_1io_ac5ecbcf7382458f8a937e4b93d27c5fe}{traccc::io::write}}(\mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, cells\_directory, \mbox{\hyperlink{namespacetraccc_af412a9ab8cc2a30a664acd9f62bb83daab5442023e55597c0c524502feb4da989}{traccc::data\_format::binary}},}
\DoxyCodeLine{56                       \mbox{\hyperlink{namespacetraccc_a503d2d50b981602cbc71693ad215b298}{vecmem::get\_data}}(cells\_csv),}
\DoxyCodeLine{57                       \mbox{\hyperlink{namespacetraccc_a503d2d50b981602cbc71693ad215b298}{vecmem::get\_data}}(modules\_csv));}
\DoxyCodeLine{58 }
\DoxyCodeLine{59     \textcolor{comment}{// Read binary file}}
\DoxyCodeLine{60     \mbox{\hyperlink{structtraccc_1_1io_1_1cell__reader__output}{traccc::io::cell\_reader\_output}} reader\_binary(\&host\_mr);}
\DoxyCodeLine{61     \mbox{\hyperlink{namespacetraccc_1_1io_a4141a99f877738d68d63f85ed5642462}{traccc::io::read\_cells}}(reader\_binary, \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, cells\_directory,}
\DoxyCodeLine{62                            \mbox{\hyperlink{namespacetraccc_af412a9ab8cc2a30a664acd9f62bb83daab5442023e55597c0c524502feb4da989}{traccc::data\_format::binary}}, \&surface\_transforms,}
\DoxyCodeLine{63                            \&digi\_cfg);}
\DoxyCodeLine{64     \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::cell\_collection\_types::host}}\& cells\_binary =}
\DoxyCodeLine{65         reader\_binary.cells;}
\DoxyCodeLine{66     \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::cell\_module\_collection\_types::host}}\& modules\_binary =}
\DoxyCodeLine{67         reader\_binary.modules;}
\DoxyCodeLine{68 }
\DoxyCodeLine{69     \textcolor{comment}{// Delete binary file}}
\DoxyCodeLine{70     std::string io\_cells\_file =}
\DoxyCodeLine{71         \mbox{\hyperlink{namespacetraccc_1_1io_adc4b3b42d06cb8ec657cdc35dec6a58f}{traccc::io::data\_directory}}() + cells\_directory +}
\DoxyCodeLine{72         \mbox{\hyperlink{namespacetraccc_1_1io_a50a83a33d8433ae43e01677765651ffb}{traccc::io::get\_event\_filename}}(\mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, \textcolor{stringliteral}{"-\/cells.dat"});}
\DoxyCodeLine{73     std::remove(io\_cells\_file.c\_str());}
\DoxyCodeLine{74 }
\DoxyCodeLine{75     ASSERT\_TRUE(!std::ifstream(io\_cells\_file));}
\DoxyCodeLine{76 }
\DoxyCodeLine{77     std::string io\_modules\_file =}
\DoxyCodeLine{78         \mbox{\hyperlink{namespacetraccc_1_1io_adc4b3b42d06cb8ec657cdc35dec6a58f}{traccc::io::data\_directory}}() + cells\_directory +}
\DoxyCodeLine{79         \mbox{\hyperlink{namespacetraccc_1_1io_a50a83a33d8433ae43e01677765651ffb}{traccc::io::get\_event\_filename}}(\mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, \textcolor{stringliteral}{"-\/modules.dat"});}
\DoxyCodeLine{80     std::remove(io\_modules\_file.c\_str());}
\DoxyCodeLine{81 }
\DoxyCodeLine{82     ASSERT\_TRUE(!std::ifstream(io\_modules\_file));}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{comment}{// Check cells size}}
\DoxyCodeLine{85     ASSERT\_TRUE(cells\_csv.size() > 0);}
\DoxyCodeLine{86     ASSERT\_EQ(cells\_csv.size(), cells\_binary.size());}
\DoxyCodeLine{87 }
\DoxyCodeLine{88     \textcolor{comment}{// Check modules size}}
\DoxyCodeLine{89     ASSERT\_TRUE(modules\_csv.size() > 0);}
\DoxyCodeLine{90     ASSERT\_EQ(modules\_csv.size(), modules\_binary.size());}
\DoxyCodeLine{91 }
\DoxyCodeLine{92     \textcolor{keywordflow}{for} (std::size\_t i = 0; i < cells\_csv.size(); i++) \{}
\DoxyCodeLine{93         ASSERT\_EQ(cells\_csv[i], cells\_binary[i]);}
\DoxyCodeLine{94     \}}
\DoxyCodeLine{95     \textcolor{keywordflow}{for} (std::size\_t i = 0; i < modules\_csv.size(); i++) \{}
\DoxyCodeLine{96         ASSERT\_EQ(modules\_csv[i].surface\_link, modules\_binary[i].surface\_link);}
\DoxyCodeLine{97         ASSERT\_EQ(modules\_csv[i].placement, modules\_binary[i].placement);}
\DoxyCodeLine{98     \}}
\DoxyCodeLine{99 \}}

\end{DoxyCode}


References traccc\+::binary, traccc\+::io\+::cell\+\_\+reader\+\_\+output\+::cells, traccc\+::csv, traccc\+::io\+::data\+\_\+directory(), event, traccc\+::get\+\_\+data(), traccc\+::io\+::get\+\_\+event\+\_\+filename(), traccc\+::io\+::cell\+\_\+reader\+\_\+output\+::modules, traccc\+::io\+::read\+\_\+cells(), traccc\+::io\+::read\+\_\+digitization\+\_\+config(), traccc\+::io\+::read\+\_\+geometry(), and traccc\+::io\+::write().

\mbox{\Hypertarget{test__binary_8cpp_a61e32821faaecee37b0e249049024982}\label{test__binary_8cpp_a61e32821faaecee37b0e249049024982}} 
\index{test\_binary.cpp@{test\_binary.cpp}!TEST@{TEST}}
\index{TEST@{TEST}!test\_binary.cpp@{test\_binary.cpp}}
\doxysubsubsection{\texorpdfstring{TEST()}{TEST()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily T\+E\+ST (\begin{DoxyParamCaption}\item[{io\+\_\+binary}]{,  }\item[{measurement}]{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{171                              \{}
\DoxyCodeLine{172     \textcolor{comment}{// Set event configuration}}
\DoxyCodeLine{173     \textcolor{keyword}{const} std::size\_t \textcolor{keyword}{event} = 0;}
\DoxyCodeLine{174     \textcolor{keyword}{const} std::string measurements\_directory = \textcolor{stringliteral}{"tml\_full/ttbar\_mu200/"};}
\DoxyCodeLine{175 }
\DoxyCodeLine{176     \textcolor{comment}{// Memory resource used by the EDM.}}
\DoxyCodeLine{177     vecmem::host\_memory\_resource host\_mr;}
\DoxyCodeLine{178 }
\DoxyCodeLine{179     \textcolor{comment}{// Read csv file}}
\DoxyCodeLine{180     \mbox{\hyperlink{structtraccc_1_1io_1_1measurement__reader__output}{traccc::io::measurement\_reader\_output}} reader\_csv(\&host\_mr);}
\DoxyCodeLine{181     \mbox{\hyperlink{namespacetraccc_1_1io_a84e36824b32d23770ed527b25f810307}{traccc::io::read\_measurements}}(reader\_csv, \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, measurements\_directory,}
\DoxyCodeLine{182                                   \mbox{\hyperlink{namespacetraccc_af412a9ab8cc2a30a664acd9f62bb83daaad4c20898046609aa6860e412b43c422}{traccc::data\_format::csv}});}
\DoxyCodeLine{183     \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::measurement\_collection\_types::host}}\& measurements\_csv =}
\DoxyCodeLine{184         reader\_csv.measurements;}
\DoxyCodeLine{185     \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::cell\_module\_collection\_types::host}}\& modules\_csv =}
\DoxyCodeLine{186         reader\_csv.modules;}
\DoxyCodeLine{187 }
\DoxyCodeLine{188     \textcolor{comment}{// Write binary file}}
\DoxyCodeLine{189     \mbox{\hyperlink{namespacetraccc_1_1io_ac5ecbcf7382458f8a937e4b93d27c5fe}{traccc::io::write}}(}
\DoxyCodeLine{190         \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, measurements\_directory, \mbox{\hyperlink{namespacetraccc_af412a9ab8cc2a30a664acd9f62bb83daab5442023e55597c0c524502feb4da989}{traccc::data\_format::binary}},}
\DoxyCodeLine{191         \mbox{\hyperlink{namespacetraccc_a503d2d50b981602cbc71693ad215b298}{vecmem::get\_data}}(measurements\_csv), \mbox{\hyperlink{namespacetraccc_a503d2d50b981602cbc71693ad215b298}{vecmem::get\_data}}(modules\_csv));}
\DoxyCodeLine{192 }
\DoxyCodeLine{193     \textcolor{comment}{// Read binary file}}
\DoxyCodeLine{194     \mbox{\hyperlink{structtraccc_1_1io_1_1measurement__reader__output}{traccc::io::measurement\_reader\_output}} reader\_binary(\&host\_mr);}
\DoxyCodeLine{195     \mbox{\hyperlink{namespacetraccc_1_1io_a84e36824b32d23770ed527b25f810307}{traccc::io::read\_measurements}}(reader\_binary, \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, measurements\_directory,}
\DoxyCodeLine{196                                   \mbox{\hyperlink{namespacetraccc_af412a9ab8cc2a30a664acd9f62bb83daab5442023e55597c0c524502feb4da989}{traccc::data\_format::binary}});}
\DoxyCodeLine{197     \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::measurement\_collection\_types::host}}\& measurements\_binary =}
\DoxyCodeLine{198         reader\_binary.measurements;}
\DoxyCodeLine{199     \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::cell\_module\_collection\_types::host}}\& modules\_binary =}
\DoxyCodeLine{200         reader\_binary.modules;}
\DoxyCodeLine{201 }
\DoxyCodeLine{202     \textcolor{comment}{// Delete binary file}}
\DoxyCodeLine{203     std::string io\_measurements\_file =}
\DoxyCodeLine{204         \mbox{\hyperlink{namespacetraccc_1_1io_adc4b3b42d06cb8ec657cdc35dec6a58f}{traccc::io::data\_directory}}() + measurements\_directory +}
\DoxyCodeLine{205         \mbox{\hyperlink{namespacetraccc_1_1io_a50a83a33d8433ae43e01677765651ffb}{traccc::io::get\_event\_filename}}(\mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, \textcolor{stringliteral}{"-\/measurements.dat"});}
\DoxyCodeLine{206     std::remove(io\_measurements\_file.c\_str());}
\DoxyCodeLine{207 }
\DoxyCodeLine{208     ASSERT\_TRUE(!std::ifstream(io\_measurements\_file));}
\DoxyCodeLine{209 }
\DoxyCodeLine{210     std::string io\_modules\_file =}
\DoxyCodeLine{211         \mbox{\hyperlink{namespacetraccc_1_1io_adc4b3b42d06cb8ec657cdc35dec6a58f}{traccc::io::data\_directory}}() + measurements\_directory +}
\DoxyCodeLine{212         \mbox{\hyperlink{namespacetraccc_1_1io_a50a83a33d8433ae43e01677765651ffb}{traccc::io::get\_event\_filename}}(\mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, \textcolor{stringliteral}{"-\/modules.dat"});}
\DoxyCodeLine{213     std::remove(io\_modules\_file.c\_str());}
\DoxyCodeLine{214 }
\DoxyCodeLine{215     ASSERT\_TRUE(!std::ifstream(io\_modules\_file));}
\DoxyCodeLine{216 }
\DoxyCodeLine{217     \textcolor{comment}{// Check header size}}
\DoxyCodeLine{218     ASSERT\_TRUE(measurements\_csv.size() > 0);}
\DoxyCodeLine{219     ASSERT\_EQ(measurements\_csv.size(), measurements\_binary.size());}
\DoxyCodeLine{220 }
\DoxyCodeLine{221     \textcolor{comment}{// Check modules size}}
\DoxyCodeLine{222     ASSERT\_TRUE(modules\_csv.size() > 0);}
\DoxyCodeLine{223     ASSERT\_EQ(modules\_csv.size(), modules\_binary.size());}
\DoxyCodeLine{224 }
\DoxyCodeLine{225     \textcolor{keywordflow}{for} (std::size\_t i = 0; i < measurements\_csv.size(); i++) \{}
\DoxyCodeLine{226         ASSERT\_EQ(measurements\_csv[i], measurements\_binary[i]);}
\DoxyCodeLine{227     \}}
\DoxyCodeLine{228     \textcolor{keywordflow}{for} (std::size\_t i = 0; i < modules\_csv.size(); i++) \{}
\DoxyCodeLine{229         ASSERT\_EQ(modules\_csv[i].surface\_link, modules\_binary[i].surface\_link);}
\DoxyCodeLine{230     \}}
\DoxyCodeLine{231 \}}

\end{DoxyCode}


References traccc\+::binary, traccc\+::csv, traccc\+::io\+::data\+\_\+directory(), event, traccc\+::get\+\_\+data(), traccc\+::io\+::get\+\_\+event\+\_\+filename(), traccc\+::io\+::measurement\+\_\+reader\+\_\+output\+::measurements, traccc\+::io\+::measurement\+\_\+reader\+\_\+output\+::modules, traccc\+::io\+::read\+\_\+measurements(), and traccc\+::io\+::write().

\mbox{\Hypertarget{test__binary_8cpp_a6ebd5d9573fedd50395db6808781e78d}\label{test__binary_8cpp_a6ebd5d9573fedd50395db6808781e78d}} 
\index{test\_binary.cpp@{test\_binary.cpp}!TEST@{TEST}}
\index{TEST@{TEST}!test\_binary.cpp@{test\_binary.cpp}}
\doxysubsubsection{\texorpdfstring{TEST()}{TEST()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily T\+E\+ST (\begin{DoxyParamCaption}\item[{io\+\_\+binary}]{,  }\item[{spacepoint}]{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{102                             \{}
\DoxyCodeLine{103 }
\DoxyCodeLine{104     \textcolor{comment}{// Set event configuration}}
\DoxyCodeLine{105     \textcolor{keyword}{const} std::size\_t \textcolor{keyword}{event} = 0;}
\DoxyCodeLine{106     \textcolor{keyword}{const} std::string hits\_directory = \textcolor{stringliteral}{"tml\_full/ttbar\_mu200/"};}
\DoxyCodeLine{107 }
\DoxyCodeLine{108     \textcolor{comment}{// Memory resource used by the EDM.}}
\DoxyCodeLine{109     vecmem::host\_memory\_resource host\_mr;}
\DoxyCodeLine{110 }
\DoxyCodeLine{111     \textcolor{comment}{// Read the surface transforms}}
\DoxyCodeLine{112     \textcolor{keyword}{auto} surface\_transforms =}
\DoxyCodeLine{113         \mbox{\hyperlink{namespacetraccc_1_1io_a5a6c904c086473a05b85a0bf060bfa8d}{traccc::io::read\_geometry}}(\textcolor{stringliteral}{"tml\_detector/trackml-\/detector.csv"});}
\DoxyCodeLine{114 }
\DoxyCodeLine{115     \textcolor{comment}{// Read csv file}}
\DoxyCodeLine{116     \mbox{\hyperlink{structtraccc_1_1io_1_1spacepoint__reader__output}{traccc::io::spacepoint\_reader\_output}} reader\_csv(\&host\_mr);}
\DoxyCodeLine{117     \mbox{\hyperlink{namespacetraccc_1_1io_afe49060da2ab77f49cfcd82308122f84}{traccc::io::read\_spacepoints}}(reader\_csv, \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, hits\_directory,}
\DoxyCodeLine{118                                  surface\_transforms, \mbox{\hyperlink{namespacetraccc_af412a9ab8cc2a30a664acd9f62bb83daaad4c20898046609aa6860e412b43c422}{traccc::data\_format::csv}});}
\DoxyCodeLine{119     \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::spacepoint\_collection\_types::host}}\& spacepoints\_csv =}
\DoxyCodeLine{120         reader\_csv.spacepoints;}
\DoxyCodeLine{121     \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::cell\_module\_collection\_types::host}}\& modules\_csv =}
\DoxyCodeLine{122         reader\_csv.modules;}
\DoxyCodeLine{123 }
\DoxyCodeLine{124     \textcolor{comment}{// // Write binary file}}
\DoxyCodeLine{125     \mbox{\hyperlink{namespacetraccc_1_1io_ac5ecbcf7382458f8a937e4b93d27c5fe}{traccc::io::write}}(\mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, hits\_directory, \mbox{\hyperlink{namespacetraccc_af412a9ab8cc2a30a664acd9f62bb83daab5442023e55597c0c524502feb4da989}{traccc::data\_format::binary}},}
\DoxyCodeLine{126                       \mbox{\hyperlink{namespacetraccc_a503d2d50b981602cbc71693ad215b298}{vecmem::get\_data}}(spacepoints\_csv),}
\DoxyCodeLine{127                       \mbox{\hyperlink{namespacetraccc_a503d2d50b981602cbc71693ad215b298}{vecmem::get\_data}}(modules\_csv));}
\DoxyCodeLine{128 }
\DoxyCodeLine{129     \textcolor{comment}{// Read binary file}}
\DoxyCodeLine{130     \mbox{\hyperlink{structtraccc_1_1io_1_1spacepoint__reader__output}{traccc::io::spacepoint\_reader\_output}} reader\_binary(\&host\_mr);}
\DoxyCodeLine{131     \mbox{\hyperlink{namespacetraccc_1_1io_afe49060da2ab77f49cfcd82308122f84}{traccc::io::read\_spacepoints}}(reader\_binary, \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, hits\_directory,}
\DoxyCodeLine{132                                  surface\_transforms,}
\DoxyCodeLine{133                                  \mbox{\hyperlink{namespacetraccc_af412a9ab8cc2a30a664acd9f62bb83daab5442023e55597c0c524502feb4da989}{traccc::data\_format::binary}});}
\DoxyCodeLine{134     \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::spacepoint\_collection\_types::host}}\& spacepoints\_binary =}
\DoxyCodeLine{135         reader\_binary.spacepoints;}
\DoxyCodeLine{136     \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::cell\_module\_collection\_types::host}}\& modules\_binary =}
\DoxyCodeLine{137         reader\_binary.modules;}
\DoxyCodeLine{138 }
\DoxyCodeLine{139     \textcolor{comment}{// Delete binary file}}
\DoxyCodeLine{140     std::string io\_spacepoints\_file =}
\DoxyCodeLine{141         \mbox{\hyperlink{namespacetraccc_1_1io_adc4b3b42d06cb8ec657cdc35dec6a58f}{traccc::io::data\_directory}}() + hits\_directory +}
\DoxyCodeLine{142         \mbox{\hyperlink{namespacetraccc_1_1io_a50a83a33d8433ae43e01677765651ffb}{traccc::io::get\_event\_filename}}(\mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, \textcolor{stringliteral}{"-\/hits.dat"});}
\DoxyCodeLine{143     std::remove(io\_spacepoints\_file.c\_str());}
\DoxyCodeLine{144 }
\DoxyCodeLine{145     ASSERT\_TRUE(!std::ifstream(io\_spacepoints\_file));}
\DoxyCodeLine{146 }
\DoxyCodeLine{147     std::string io\_modules\_file =}
\DoxyCodeLine{148         \mbox{\hyperlink{namespacetraccc_1_1io_adc4b3b42d06cb8ec657cdc35dec6a58f}{traccc::io::data\_directory}}() + hits\_directory +}
\DoxyCodeLine{149         \mbox{\hyperlink{namespacetraccc_1_1io_a50a83a33d8433ae43e01677765651ffb}{traccc::io::get\_event\_filename}}(\mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, \textcolor{stringliteral}{"-\/modules.dat"});}
\DoxyCodeLine{150     std::remove(io\_modules\_file.c\_str());}
\DoxyCodeLine{151 }
\DoxyCodeLine{152     ASSERT\_TRUE(!std::ifstream(io\_modules\_file));}
\DoxyCodeLine{153 }
\DoxyCodeLine{154     \textcolor{comment}{// Check spacepoints size}}
\DoxyCodeLine{155     ASSERT\_TRUE(spacepoints\_csv.size() > 0);}
\DoxyCodeLine{156     ASSERT\_EQ(spacepoints\_csv.size(), spacepoints\_binary.size());}
\DoxyCodeLine{157 }
\DoxyCodeLine{158     \textcolor{comment}{// Check modules size}}
\DoxyCodeLine{159     ASSERT\_TRUE(modules\_csv.size() > 0);}
\DoxyCodeLine{160     ASSERT\_EQ(modules\_csv.size(), modules\_binary.size());}
\DoxyCodeLine{161 }
\DoxyCodeLine{162     \textcolor{keywordflow}{for} (std::size\_t i = 0; i < spacepoints\_csv.size(); i++) \{}
\DoxyCodeLine{163         ASSERT\_EQ(spacepoints\_csv[i], spacepoints\_binary[i]);}
\DoxyCodeLine{164     \}}
\DoxyCodeLine{165     \textcolor{keywordflow}{for} (std::size\_t i = 0; i < modules\_csv.size(); i++) \{}
\DoxyCodeLine{166         ASSERT\_EQ(modules\_csv[i], modules\_binary[i]);}
\DoxyCodeLine{167     \}}
\DoxyCodeLine{168 \}}

\end{DoxyCode}


References traccc\+::binary, traccc\+::csv, traccc\+::io\+::data\+\_\+directory(), event, traccc\+::get\+\_\+data(), traccc\+::io\+::get\+\_\+event\+\_\+filename(), traccc\+::io\+::spacepoint\+\_\+reader\+\_\+output\+::modules, traccc\+::io\+::read\+\_\+geometry(), traccc\+::io\+::read\+\_\+spacepoints(), traccc\+::io\+::spacepoint\+\_\+reader\+\_\+output\+::spacepoints, and traccc\+::io\+::write().

