\hypertarget{truth__fitting__example__cuda_8cpp}{}\doxysection{examples/run/cuda/truth\+\_\+fitting\+\_\+example\+\_\+cuda.cpp File Reference}
\label{truth__fitting__example__cuda_8cpp}\index{examples/run/cuda/truth\_fitting\_example\_cuda.cpp@{examples/run/cuda/truth\_fitting\_example\_cuda.cpp}}
{\ttfamily \#include \char`\"{}traccc/cuda/fitting/fitting\+\_\+algorithm.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/cuda/utils/stream.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/definitions/common.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/definitions/primitives.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/device/container\+\_\+d2h\+\_\+copy\+\_\+alg.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/device/container\+\_\+h2d\+\_\+copy\+\_\+alg.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/fitting/fitting\+\_\+algorithm.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/fitting/kalman\+\_\+filter/kalman\+\_\+fitter.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/io/read\+\_\+geometry.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/io/read\+\_\+measurements.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/io/utils.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/options/common\+\_\+options.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/options/detector\+\_\+input\+\_\+options.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/options/handle\+\_\+argument\+\_\+errors.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/options/propagation\+\_\+options.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/performance/collection\+\_\+comparator.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/performance/container\+\_\+comparator.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/performance/timer.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/resolution/fitting\+\_\+performance\+\_\+writer.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/utils/seed\+\_\+generator.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}detray/core/detector.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}detray/core/detector\+\_\+metadata.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}detray/detectors/bfield.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}detray/io/common/detector\+\_\+reader.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}detray/propagator/navigator.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}detray/propagator/propagator.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}detray/propagator/rk\+\_\+stepper.\+hpp\char`\"{}}\newline
{\ttfamily \#include $<$vecmem/memory/cuda/device\+\_\+memory\+\_\+resource.\+hpp$>$}\newline
{\ttfamily \#include $<$vecmem/memory/cuda/host\+\_\+memory\+\_\+resource.\+hpp$>$}\newline
{\ttfamily \#include $<$vecmem/memory/cuda/managed\+\_\+memory\+\_\+resource.\+hpp$>$}\newline
{\ttfamily \#include $<$vecmem/memory/host\+\_\+memory\+\_\+resource.\+hpp$>$}\newline
{\ttfamily \#include $<$vecmem/utils/cuda/async\+\_\+copy.\+hpp$>$}\newline
{\ttfamily \#include $<$exception$>$}\newline
{\ttfamily \#include $<$iomanip$>$}\newline
{\ttfamily \#include $<$iostream$>$}\newline
Include dependency graph for truth\+\_\+fitting\+\_\+example\+\_\+cuda.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dc/d30/truth__fitting__example__cuda_8cpp__incl}
\end{center}
\end{figure}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{truth__fitting__example__cuda_8cpp_a0ddf1224851353fc92bfbff6f499fa97}{main}} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{truth__fitting__example__cuda_8cpp_a0ddf1224851353fc92bfbff6f499fa97}\label{truth__fitting__example__cuda_8cpp_a0ddf1224851353fc92bfbff6f499fa97}} 
\index{truth\_fitting\_example\_cuda.cpp@{truth\_fitting\_example\_cuda.cpp}!main@{main}}
\index{main@{main}!truth\_fitting\_example\_cuda.cpp@{truth\_fitting\_example\_cuda.cpp}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

Type declarations

Standard deviations for seed track parameters
\begin{DoxyCode}{0}
\DoxyCodeLine{56                                  \{}
\DoxyCodeLine{57     \textcolor{comment}{// Set up the program options}}
\DoxyCodeLine{58     po::options\_description desc(\textcolor{stringliteral}{"Allowed options"});}
\DoxyCodeLine{59 }
\DoxyCodeLine{60     \textcolor{comment}{// Add options}}
\DoxyCodeLine{61     desc.add\_options()(\textcolor{stringliteral}{"help,h"}, \textcolor{stringliteral}{"Give some help with the program's options"});}
\DoxyCodeLine{62     \mbox{\hyperlink{structtraccc_1_1common__options}{traccc::common\_options}} common\_opts(desc);}
\DoxyCodeLine{63     \mbox{\hyperlink{structtraccc_1_1detector__input__options}{traccc::detector\_input\_options}} det\_opts(desc);}
\DoxyCodeLine{64     \mbox{\hyperlink{structtraccc_1_1propagation__options}{traccc::propagation\_options<scalar>}} propagation\_opts(desc);}
\DoxyCodeLine{65     desc.add\_options()(\textcolor{stringliteral}{"run\_cpu"}, po::value<bool>()-\/>default\_value(\textcolor{keyword}{false}),}
\DoxyCodeLine{66                        \textcolor{stringliteral}{"run cpu tracking as well"});}
\DoxyCodeLine{67 }
\DoxyCodeLine{68     po::variables\_map vm;}
\DoxyCodeLine{69     po::store(po::parse\_command\_line(argc, argv, desc), vm);}
\DoxyCodeLine{70 }
\DoxyCodeLine{71     \textcolor{comment}{// Check errors}}
\DoxyCodeLine{72     \mbox{\hyperlink{namespacetraccc_a018e1f5ae8dbab3e118c08cfb905be01}{traccc::handle\_argument\_errors}}(vm, desc);}
\DoxyCodeLine{73 }
\DoxyCodeLine{74     \textcolor{comment}{// Read options}}
\DoxyCodeLine{75     common\_opts.read(vm);}
\DoxyCodeLine{76     det\_opts.read(vm);}
\DoxyCodeLine{77 }
\DoxyCodeLine{78     propagation\_opts.read(vm);}
\DoxyCodeLine{79     \textcolor{keyword}{auto} run\_cpu = vm[\textcolor{stringliteral}{"run\_cpu"}].as<\textcolor{keywordtype}{bool}>();}
\DoxyCodeLine{80 }
\DoxyCodeLine{81     std::cout << \textcolor{stringliteral}{"Running "} << argv[0] << \textcolor{stringliteral}{" "} << common\_opts.input\_directory}
\DoxyCodeLine{82               << \textcolor{stringliteral}{" "} << common\_opts.events << std::endl;}
\DoxyCodeLine{83 }
\DoxyCodeLine{85     \textcolor{keyword}{using} host\_detector\_type = detray::detector<detray::default\_metadata,}
\DoxyCodeLine{86                                                 detray::host\_container\_types>;}
\DoxyCodeLine{87     \textcolor{keyword}{using} device\_detector\_type =}
\DoxyCodeLine{88         detray::detector<detray::default\_metadata,}
\DoxyCodeLine{89                          detray::device\_container\_types>;}
\DoxyCodeLine{90 }
\DoxyCodeLine{91     \textcolor{keyword}{using} b\_field\_t = covfie::field<detray::bfield::const\_bknd\_t>;}
\DoxyCodeLine{92     \textcolor{keyword}{using} rk\_stepper\_type =}
\DoxyCodeLine{93         detray::rk\_stepper<b\_field\_t::view\_t, \mbox{\hyperlink{namespacetraccc_a7d1f91ecd225f32ea85349bf0bc8adb8}{traccc::transform3}},}
\DoxyCodeLine{94                            detray::constrained\_step<>>;}
\DoxyCodeLine{95     \textcolor{keyword}{using} host\_navigator\_type = detray::navigator<const host\_detector\_type>;}
\DoxyCodeLine{96     \textcolor{keyword}{using} host\_fitter\_type =}
\DoxyCodeLine{97         \mbox{\hyperlink{classtraccc_1_1kalman__fitter}{traccc::kalman\_fitter<rk\_stepper\_type, host\_navigator\_type>}};}
\DoxyCodeLine{98     \textcolor{keyword}{using} device\_navigator\_type = detray::navigator<const device\_detector\_type>;}
\DoxyCodeLine{99     \textcolor{keyword}{using} device\_fitter\_type =}
\DoxyCodeLine{100         \mbox{\hyperlink{classtraccc_1_1kalman__fitter}{traccc::kalman\_fitter<rk\_stepper\_type, device\_navigator\_type>}};}
\DoxyCodeLine{101 }
\DoxyCodeLine{102     \textcolor{comment}{// Memory resources used by the application.}}
\DoxyCodeLine{103     vecmem::host\_memory\_resource host\_mr;}
\DoxyCodeLine{104     vecmem::cuda::host\_memory\_resource cuda\_host\_mr;}
\DoxyCodeLine{105     vecmem::cuda::managed\_memory\_resource mng\_mr;}
\DoxyCodeLine{106     vecmem::cuda::device\_memory\_resource device\_mr;}
\DoxyCodeLine{107     \mbox{\hyperlink{structtraccc_1_1memory__resource}{traccc::memory\_resource}} mr\{device\_mr, \&cuda\_host\_mr\};}
\DoxyCodeLine{108 }
\DoxyCodeLine{109     \textcolor{comment}{// Performance writer}}
\DoxyCodeLine{110     \mbox{\hyperlink{classtraccc_1_1fitting__performance__writer}{traccc::fitting\_performance\_writer}} fit\_performance\_writer(}
\DoxyCodeLine{111         \mbox{\hyperlink{structtraccc_1_1fitting__performance__writer_1_1config}{traccc::fitting\_performance\_writer::config}}\{\});}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     \textcolor{comment}{// Output Stats}}
\DoxyCodeLine{114     std::size\_t n\_fitted\_tracks = 0;}
\DoxyCodeLine{115     std::size\_t n\_fitted\_tracks\_cuda = 0;}
\DoxyCodeLine{116 }
\DoxyCodeLine{117 \textcolor{comment}{    /*****************************}}
\DoxyCodeLine{118 \textcolor{comment}{     * Build a geometry}}
\DoxyCodeLine{119 \textcolor{comment}{     *****************************/}}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     \textcolor{comment}{// B field value and its type}}
\DoxyCodeLine{122     \textcolor{comment}{// @TODO: Set B field as argument}}
\DoxyCodeLine{123     \textcolor{keyword}{const} \mbox{\hyperlink{namespacetraccc_a3e92464c509aa7ac245244b6083357c2}{traccc::vector3}} B\{0, 0, 2 * detray::unit<traccc::scalar>::T\};}
\DoxyCodeLine{124     \textcolor{keyword}{auto} field = detray::bfield::create\_const\_field(B);}
\DoxyCodeLine{125 }
\DoxyCodeLine{126     \textcolor{comment}{// Read the detector}}
\DoxyCodeLine{127     detray::io::detector\_reader\_config reader\_cfg\{\};}
\DoxyCodeLine{128     reader\_cfg.add\_file(\mbox{\hyperlink{namespacetraccc_1_1io_adc4b3b42d06cb8ec657cdc35dec6a58f}{traccc::io::data\_directory}}() + det\_opts.detector\_file);}
\DoxyCodeLine{129     \textcolor{keywordflow}{if} (!det\_opts.material\_file.empty()) \{}
\DoxyCodeLine{130         reader\_cfg.add\_file(\mbox{\hyperlink{namespacetraccc_1_1io_adc4b3b42d06cb8ec657cdc35dec6a58f}{traccc::io::data\_directory}}() +}
\DoxyCodeLine{131                             det\_opts.material\_file);}
\DoxyCodeLine{132     \}}
\DoxyCodeLine{133     \textcolor{keywordflow}{if} (!det\_opts.grid\_file.empty()) \{}
\DoxyCodeLine{134         reader\_cfg.add\_file(\mbox{\hyperlink{namespacetraccc_1_1io_adc4b3b42d06cb8ec657cdc35dec6a58f}{traccc::io::data\_directory}}() + det\_opts.grid\_file);}
\DoxyCodeLine{135     \}}
\DoxyCodeLine{136     \textcolor{keyword}{auto} [host\_det, names] =}
\DoxyCodeLine{137         detray::io::read\_detector<host\_detector\_type>(mng\_mr, reader\_cfg);}
\DoxyCodeLine{138 }
\DoxyCodeLine{139     \textcolor{comment}{// Detector view object}}
\DoxyCodeLine{140     \textcolor{keyword}{auto} det\_view = \mbox{\hyperlink{namespacetraccc_a503d2d50b981602cbc71693ad215b298}{detray::get\_data}}(host\_det);}
\DoxyCodeLine{141 }
\DoxyCodeLine{142 \textcolor{comment}{    /*****************************}}
\DoxyCodeLine{143 \textcolor{comment}{     * Do the reconstruction}}
\DoxyCodeLine{144 \textcolor{comment}{     *****************************/}}
\DoxyCodeLine{145 }
\DoxyCodeLine{146     \textcolor{comment}{// Stream object}}
\DoxyCodeLine{147     \mbox{\hyperlink{classtraccc_1_1cuda_1_1stream}{traccc::cuda::stream}} stream;}
\DoxyCodeLine{148 }
\DoxyCodeLine{149     \textcolor{comment}{// Copy object}}
\DoxyCodeLine{150     vecmem::cuda::async\_copy async\_copy\{stream.\mbox{\hyperlink{classtraccc_1_1cuda_1_1stream_ad8224b3cebfca8079e035a10a9b1e20f}{cudaStream}}()\};}
\DoxyCodeLine{151 }
\DoxyCodeLine{152     \mbox{\hyperlink{classtraccc_1_1device_1_1container__h2d__copy__alg}{traccc::device::container\_h2d\_copy\_alg}}<}
\DoxyCodeLine{153         \mbox{\hyperlink{structtraccc_1_1container__types}{traccc::track\_candidate\_container\_types}}>}
\DoxyCodeLine{154         track\_candidate\_h2d\{mr, async\_copy\};}
\DoxyCodeLine{155 }
\DoxyCodeLine{156     \mbox{\hyperlink{classtraccc_1_1device_1_1container__d2h__copy__alg}{traccc::device::container\_d2h\_copy\_alg<traccc::track\_state\_container\_types>}}}
\DoxyCodeLine{157         track\_state\_d2h\{mr, async\_copy\};}
\DoxyCodeLine{158 }
\DoxyCodeLine{160     \textcolor{keyword}{static} constexpr std::array<scalar, e\_bound\_size> stddevs = \{}
\DoxyCodeLine{161         0.03 * detray::unit<scalar>::mm,}
\DoxyCodeLine{162         0.03 * detray::unit<scalar>::mm,}
\DoxyCodeLine{163         0.017,}
\DoxyCodeLine{164         0.017,}
\DoxyCodeLine{165         0.01 / detray::unit<scalar>::GeV,}
\DoxyCodeLine{166         1 * detray::unit<scalar>::ns\};}
\DoxyCodeLine{167 }
\DoxyCodeLine{168     \textcolor{comment}{// Fitting algorithm object}}
\DoxyCodeLine{169     \textcolor{keyword}{typename} \mbox{\hyperlink{classtraccc_1_1fitting__algorithm_acfb92fd90e59587020bacc978ebe275c}{traccc::fitting\_algorithm<host\_fitter\_type>::config\_type}} fit\_cfg;}
\DoxyCodeLine{170     fit\_cfg.step\_constraint = propagation\_opts.step\_constraint;}
\DoxyCodeLine{171     \mbox{\hyperlink{classtraccc_1_1fitting__algorithm}{traccc::fitting\_algorithm<host\_fitter\_type>}} host\_fitting(fit\_cfg);}
\DoxyCodeLine{172     \mbox{\hyperlink{classtraccc_1_1cuda_1_1fitting__algorithm}{traccc::cuda::fitting\_algorithm<device\_fitter\_type>}} device\_fitting(}
\DoxyCodeLine{173         fit\_cfg, mr, async\_copy, stream);}
\DoxyCodeLine{174 }
\DoxyCodeLine{175     \textcolor{comment}{// Seed generator}}
\DoxyCodeLine{176     \mbox{\hyperlink{structtraccc_1_1seed__generator}{traccc::seed\_generator<host\_detector\_type>}} sg(host\_det, stddevs);}
\DoxyCodeLine{177 }
\DoxyCodeLine{178     \mbox{\hyperlink{structtraccc_1_1performance_1_1timing__info}{traccc::performance::timing\_info}} elapsedTimes;}
\DoxyCodeLine{179 }
\DoxyCodeLine{180     \textcolor{comment}{// Iterate over events}}
\DoxyCodeLine{181     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}} = common\_opts.skip;}
\DoxyCodeLine{182          \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}} < common\_opts.events + common\_opts.skip; ++\mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}) \{}
\DoxyCodeLine{183 }
\DoxyCodeLine{184         \textcolor{comment}{// Truth Track Candidates}}
\DoxyCodeLine{185         \mbox{\hyperlink{structtraccc_1_1event__map2}{traccc::event\_map2}} evt\_map2(\mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, common\_opts.input\_directory,}
\DoxyCodeLine{186                                     common\_opts.input\_directory,}
\DoxyCodeLine{187                                     common\_opts.input\_directory);}
\DoxyCodeLine{188 }
\DoxyCodeLine{189         \mbox{\hyperlink{classtraccc_1_1host__container}{traccc::track\_candidate\_container\_types::host}} truth\_track\_candidates =}
\DoxyCodeLine{190             evt\_map2.generate\_truth\_candidates(sg, host\_mr);}
\DoxyCodeLine{191 }
\DoxyCodeLine{192         \textcolor{comment}{// track candidates buffer}}
\DoxyCodeLine{193         \textcolor{keyword}{const} \mbox{\hyperlink{structtraccc_1_1container__buffer}{traccc::track\_candidate\_container\_types::buffer}}}
\DoxyCodeLine{194             truth\_track\_candidates\_cuda\_buffer =}
\DoxyCodeLine{195                 track\_candidate\_h2d(\mbox{\hyperlink{namespacetraccc_a503d2d50b981602cbc71693ad215b298}{traccc::get\_data}}(truth\_track\_candidates));}
\DoxyCodeLine{196 }
\DoxyCodeLine{197         \textcolor{comment}{// Navigation buffer}}
\DoxyCodeLine{198         \textcolor{keyword}{auto} navigation\_buffer = detray::create\_candidates\_buffer(}
\DoxyCodeLine{199             host\_det, truth\_track\_candidates.\mbox{\hyperlink{classtraccc_1_1host__container_afb9ec4efd2a4fc601cafb57db9ebe30e}{size}}(), mr.main, mr.host);}
\DoxyCodeLine{200 }
\DoxyCodeLine{201         \textcolor{comment}{// Instantiate cuda containers/collections}}
\DoxyCodeLine{202         \mbox{\hyperlink{structtraccc_1_1container__buffer}{traccc::track\_state\_container\_types::buffer}} track\_states\_cuda\_buffer\{}
\DoxyCodeLine{203             \{\{\}, *(mr.host)\}, \{\{\}, *(mr.host), mr.host\}\};}
\DoxyCodeLine{204 }
\DoxyCodeLine{205         \{}
\DoxyCodeLine{206             \mbox{\hyperlink{classtraccc_1_1performance_1_1timer}{traccc::performance::timer}} t(\textcolor{stringliteral}{"Track fitting  (cuda)"}, elapsedTimes);}
\DoxyCodeLine{207 }
\DoxyCodeLine{208             \textcolor{comment}{// Run fitting}}
\DoxyCodeLine{209             track\_states\_cuda\_buffer =}
\DoxyCodeLine{210                 device\_fitting(det\_view, field, navigation\_buffer,}
\DoxyCodeLine{211                                truth\_track\_candidates\_cuda\_buffer);}
\DoxyCodeLine{212         \}}
\DoxyCodeLine{213 }
\DoxyCodeLine{214         \mbox{\hyperlink{classtraccc_1_1host__container}{traccc::track\_state\_container\_types::host}} track\_states\_cuda =}
\DoxyCodeLine{215             track\_state\_d2h(track\_states\_cuda\_buffer);}
\DoxyCodeLine{216 }
\DoxyCodeLine{217         \textcolor{comment}{// CPU container(s)}}
\DoxyCodeLine{218         \mbox{\hyperlink{classtraccc_1_1fitting__algorithm}{traccc::fitting\_algorithm<host\_fitter\_type>::output\_type}} track\_states;}
\DoxyCodeLine{219 }
\DoxyCodeLine{220         \textcolor{keywordflow}{if} (run\_cpu) \{}
\DoxyCodeLine{221 }
\DoxyCodeLine{222             \{}
\DoxyCodeLine{223                 \mbox{\hyperlink{classtraccc_1_1performance_1_1timer}{traccc::performance::timer}} t(\textcolor{stringliteral}{"Track fitting  (cpu)"},}
\DoxyCodeLine{224                                              elapsedTimes);}
\DoxyCodeLine{225 }
\DoxyCodeLine{226                 \textcolor{comment}{// Run fitting}}
\DoxyCodeLine{227                 track\_states =}
\DoxyCodeLine{228                     host\_fitting(host\_det, field, truth\_track\_candidates);}
\DoxyCodeLine{229             \}}
\DoxyCodeLine{230         \}}
\DoxyCodeLine{231 }
\DoxyCodeLine{232         \textcolor{keywordflow}{if} (run\_cpu) \{}
\DoxyCodeLine{233             \textcolor{comment}{// Show which event we are currently presenting the results for.}}
\DoxyCodeLine{234             std::cout << \textcolor{stringliteral}{"===>>> Event "} << \textcolor{keyword}{event} << \textcolor{stringliteral}{" <<<==="} << std::endl;}
\DoxyCodeLine{235 }
\DoxyCodeLine{236             \textcolor{comment}{// Compare the track parameters made on the host and on the device.}}
\DoxyCodeLine{237             \mbox{\hyperlink{classtraccc_1_1collection__comparator}{traccc::collection\_comparator<traccc::fitter\_info<transform3>}}>}
\DoxyCodeLine{238                 compare\_fitter\_infos\{\textcolor{stringliteral}{"fitted tracks"}\};}
\DoxyCodeLine{239             compare\_fitter\_infos(}
\DoxyCodeLine{240                 \mbox{\hyperlink{namespacetraccc_a503d2d50b981602cbc71693ad215b298}{vecmem::get\_data}}(track\_states.get\_headers()),}
\DoxyCodeLine{241                 \mbox{\hyperlink{namespacetraccc_a503d2d50b981602cbc71693ad215b298}{vecmem::get\_data}}(track\_states\_cuda.\mbox{\hyperlink{classtraccc_1_1container__base_a72b19ad19ca520186db8f70baeafb679}{get\_headers}}()));}
\DoxyCodeLine{242         \}}
\DoxyCodeLine{243 }
\DoxyCodeLine{244         \textcolor{comment}{// Statistics}}
\DoxyCodeLine{245         n\_fitted\_tracks += track\_states.size();}
\DoxyCodeLine{246         n\_fitted\_tracks\_cuda += track\_states\_cuda.\mbox{\hyperlink{classtraccc_1_1host__container_afb9ec4efd2a4fc601cafb57db9ebe30e}{size}}();}
\DoxyCodeLine{247 }
\DoxyCodeLine{248         \textcolor{keywordflow}{if} (common\_opts.check\_performance) \{}
\DoxyCodeLine{249             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < track\_states\_cuda.\mbox{\hyperlink{classtraccc_1_1host__container_afb9ec4efd2a4fc601cafb57db9ebe30e}{size}}(); i++) \{}
\DoxyCodeLine{250                 \textcolor{keyword}{const} \textcolor{keyword}{auto}\& trk\_states\_per\_track =}
\DoxyCodeLine{251                     track\_states\_cuda.\mbox{\hyperlink{classtraccc_1_1host__container_a22f19b70178832415310bb4fd17b9d48}{at}}(i).\mbox{\hyperlink{structtraccc_1_1container__element_a7b11224d4a0d42c39758fb2b739014f2}{items}};}
\DoxyCodeLine{252 }
\DoxyCodeLine{253                 \textcolor{keyword}{const} \textcolor{keyword}{auto}\& fit\_info = track\_states\_cuda[i].header;}
\DoxyCodeLine{254 }
\DoxyCodeLine{255                 fit\_performance\_writer.write(trk\_states\_per\_track, fit\_info,}
\DoxyCodeLine{256                                              host\_det, evt\_map2);}
\DoxyCodeLine{257             \}}
\DoxyCodeLine{258         \}}
\DoxyCodeLine{259     \}}
\DoxyCodeLine{260 }
\DoxyCodeLine{261     \textcolor{keywordflow}{if} (common\_opts.check\_performance) \{}
\DoxyCodeLine{262         fit\_performance\_writer.finalize();}
\DoxyCodeLine{263     \}}
\DoxyCodeLine{264 }
\DoxyCodeLine{265     std::cout << \textcolor{stringliteral}{"==> Statistics ... "} << std::endl;}
\DoxyCodeLine{266     std::cout << \textcolor{stringliteral}{"-\/ created (cuda) "} << n\_fitted\_tracks\_cuda << \textcolor{stringliteral}{" fitted tracks"}}
\DoxyCodeLine{267               << std::endl;}
\DoxyCodeLine{268     std::cout << \textcolor{stringliteral}{"-\/ created  (cpu) "} << n\_fitted\_tracks << \textcolor{stringliteral}{" fitted tracks"}}
\DoxyCodeLine{269               << std::endl;}
\DoxyCodeLine{270     std::cout << \textcolor{stringliteral}{"==>Elapsed times...\(\backslash\)n"} << elapsedTimes << std::endl;}
\DoxyCodeLine{271 }
\DoxyCodeLine{272     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{273 \}}

\end{DoxyCode}


References traccc\+::host\+\_\+container$<$ header\+\_\+t, item\+\_\+t $>$\+::at(), traccc\+::common\+\_\+options\+::check\+\_\+performance, traccc\+::cuda\+::stream\+::cuda\+Stream(), traccc\+::io\+::data\+\_\+directory(), traccc\+::detector\+\_\+input\+\_\+options\+::detector\+\_\+file, event, traccc\+::common\+\_\+options\+::events, traccc\+::event\+\_\+map2\+::generate\+\_\+truth\+\_\+candidates(), traccc\+::get\+\_\+data(), traccc\+::container\+\_\+base$<$ header\+\_\+t, item\+\_\+t, vector\+\_\+t, jagged\+\_\+vector\+\_\+t, pair\+\_\+t $>$\+::get\+\_\+headers(), traccc\+::detector\+\_\+input\+\_\+options\+::grid\+\_\+file, traccc\+::handle\+\_\+argument\+\_\+errors(), traccc\+::common\+\_\+options\+::input\+\_\+directory, traccc\+::container\+\_\+element$<$ header\+\_\+reference\+\_\+t, vector\+\_\+reference\+\_\+t $>$\+::items, traccc\+::detector\+\_\+input\+\_\+options\+::material\+\_\+file, traccc\+::detector\+\_\+input\+\_\+options\+::read(), traccc\+::common\+\_\+options\+::read(), traccc\+::propagation\+\_\+options$<$ scalar\+\_\+t $>$\+::read(), traccc\+::host\+\_\+container$<$ header\+\_\+t, item\+\_\+t $>$\+::size(), traccc\+::common\+\_\+options\+::skip, and traccc\+::propagation\+\_\+options$<$ scalar\+\_\+t $>$\+::step\+\_\+constraint.

