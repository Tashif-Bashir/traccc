\hypertarget{seq__example_8cpp}{}\doxysection{examples/run/cpu/seq\+\_\+example.cpp File Reference}
\label{seq__example_8cpp}\index{examples/run/cpu/seq\_example.cpp@{examples/run/cpu/seq\_example.cpp}}
{\ttfamily \#include \char`\"{}traccc/io/read\+\_\+cells.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/io/read\+\_\+digitization\+\_\+config.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/io/read\+\_\+geometry.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/clusterization/clusterization\+\_\+algorithm.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/clusterization/spacepoint\+\_\+formation.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/seeding/seeding\+\_\+algorithm.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/seeding/track\+\_\+params\+\_\+estimation.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/efficiency/seeding\+\_\+performance\+\_\+writer.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/options/common\+\_\+options.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/options/detector\+\_\+input\+\_\+options.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/options/full\+\_\+tracking\+\_\+input\+\_\+options.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}traccc/options/handle\+\_\+argument\+\_\+errors.\+hpp\char`\"{}}\newline
{\ttfamily \#include $<$vecmem/memory/host\+\_\+memory\+\_\+resource.\+hpp$>$}\newline
{\ttfamily \#include $<$exception$>$}\newline
{\ttfamily \#include $<$iostream$>$}\newline
Include dependency graph for seq\+\_\+example.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/db0/seq__example_8cpp__incl}
\end{center}
\end{figure}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{seq__example_8cpp_ace794442e1f4082c86585eddee321fcf}{seq\+\_\+run}} (const \mbox{\hyperlink{structtraccc_1_1full__tracking__input__config}{traccc\+::full\+\_\+tracking\+\_\+input\+\_\+config}} \&i\+\_\+cfg, const \mbox{\hyperlink{structtraccc_1_1common__options}{traccc\+::common\+\_\+options}} \&common\+\_\+opts, const \mbox{\hyperlink{structtraccc_1_1detector__input__options}{traccc\+::detector\+\_\+input\+\_\+options}} \&det\+\_\+opts)
\item 
int \mbox{\hyperlink{seq__example_8cpp_a0ddf1224851353fc92bfbff6f499fa97}{main}} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{seq__example_8cpp_a0ddf1224851353fc92bfbff6f499fa97}\label{seq__example_8cpp_a0ddf1224851353fc92bfbff6f499fa97}} 
\index{seq\_example.cpp@{seq\_example.cpp}!main@{main}}
\index{main@{main}!seq\_example.cpp@{seq\_example.cpp}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{157                                  \{}
\DoxyCodeLine{158     \textcolor{comment}{// Set up the program options}}
\DoxyCodeLine{159     po::options\_description desc(\textcolor{stringliteral}{"Allowed options"});}
\DoxyCodeLine{160 }
\DoxyCodeLine{161     \textcolor{comment}{// Add options}}
\DoxyCodeLine{162     desc.add\_options()(\textcolor{stringliteral}{"help,h"}, \textcolor{stringliteral}{"Give some help with the program's options"});}
\DoxyCodeLine{163     \mbox{\hyperlink{structtraccc_1_1common__options}{traccc::common\_options}} common\_opts(desc);}
\DoxyCodeLine{164     \mbox{\hyperlink{structtraccc_1_1detector__input__options}{traccc::detector\_input\_options}} det\_opts(desc);}
\DoxyCodeLine{165     \mbox{\hyperlink{structtraccc_1_1full__tracking__input__config}{traccc::full\_tracking\_input\_config}} full\_tracking\_input\_cfg(desc);}
\DoxyCodeLine{166 }
\DoxyCodeLine{167     po::variables\_map vm;}
\DoxyCodeLine{168     po::store(po::parse\_command\_line(argc, argv, desc), vm);}
\DoxyCodeLine{169 }
\DoxyCodeLine{170     \textcolor{comment}{// Check errors}}
\DoxyCodeLine{171     \mbox{\hyperlink{namespacetraccc_a018e1f5ae8dbab3e118c08cfb905be01}{traccc::handle\_argument\_errors}}(vm, desc);}
\DoxyCodeLine{172 }
\DoxyCodeLine{173     \textcolor{comment}{// Read options}}
\DoxyCodeLine{174     common\_opts.read(vm);}
\DoxyCodeLine{175     det\_opts.read(vm);}
\DoxyCodeLine{176     full\_tracking\_input\_cfg.read(vm);}
\DoxyCodeLine{177 }
\DoxyCodeLine{178     std::cout << \textcolor{stringliteral}{"Running "} << argv[0] << \textcolor{stringliteral}{" "}}
\DoxyCodeLine{179               << full\_tracking\_input\_cfg.detector\_file << \textcolor{stringliteral}{" "}}
\DoxyCodeLine{180               << common\_opts.input\_directory << \textcolor{stringliteral}{" "} << common\_opts.events}
\DoxyCodeLine{181               << std::endl;}
\DoxyCodeLine{182 }
\DoxyCodeLine{183     \textcolor{keywordflow}{return} \mbox{\hyperlink{seq__example_8cpp_ace794442e1f4082c86585eddee321fcf}{seq\_run}}(full\_tracking\_input\_cfg, common\_opts, det\_opts);}
\DoxyCodeLine{184 \}}

\end{DoxyCode}


References traccc\+::full\+\_\+tracking\+\_\+input\+\_\+config\+::detector\+\_\+file, traccc\+::common\+\_\+options\+::events, traccc\+::handle\+\_\+argument\+\_\+errors(), traccc\+::common\+\_\+options\+::input\+\_\+directory, traccc\+::full\+\_\+tracking\+\_\+input\+\_\+config\+::read(), traccc\+::detector\+\_\+input\+\_\+options\+::read(), traccc\+::common\+\_\+options\+::read(), and seq\+\_\+run().

\mbox{\Hypertarget{seq__example_8cpp_ace794442e1f4082c86585eddee321fcf}\label{seq__example_8cpp_ace794442e1f4082c86585eddee321fcf}} 
\index{seq\_example.cpp@{seq\_example.cpp}!seq\_run@{seq\_run}}
\index{seq\_run@{seq\_run}!seq\_example.cpp@{seq\_example.cpp}}
\doxysubsubsection{\texorpdfstring{seq\_run()}{seq\_run()}}
{\footnotesize\ttfamily int seq\+\_\+run (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structtraccc_1_1full__tracking__input__config}{traccc\+::full\+\_\+tracking\+\_\+input\+\_\+config}} \&}]{i\+\_\+cfg,  }\item[{const \mbox{\hyperlink{structtraccc_1_1common__options}{traccc\+::common\+\_\+options}} \&}]{common\+\_\+opts,  }\item[{const \mbox{\hyperlink{structtraccc_1_1detector__input__options}{traccc\+::detector\+\_\+input\+\_\+options}} \&}]{det\+\_\+opts }\end{DoxyParamCaption})}

T\+R\+A\+C\+CC library, part of the A\+C\+TS project (R\&D line)

(c) 2021-\/2023 C\+E\+RN for the benefit of the A\+C\+TS project

Mozilla Public License Version 2.\+0 
\begin{DoxyCode}{0}
\DoxyCodeLine{39                                                           \{}
\DoxyCodeLine{40 }
\DoxyCodeLine{41     \textcolor{comment}{// Read the surface transforms}}
\DoxyCodeLine{42     \textcolor{keyword}{auto} surface\_transforms = \mbox{\hyperlink{namespacetraccc_1_1io_a5a6c904c086473a05b85a0bf060bfa8d}{traccc::io::read\_geometry}}(det\_opts.\mbox{\hyperlink{structtraccc_1_1detector__input__options_a1121f57fa16a57c9d2cef56f94390bcb}{detector\_file}});}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     \textcolor{comment}{// Read the digitization configuration file}}
\DoxyCodeLine{45     \textcolor{keyword}{auto} digi\_cfg =}
\DoxyCodeLine{46         \mbox{\hyperlink{namespacetraccc_1_1io_aa6519a2968b73b699f1aee456d80c190}{traccc::io::read\_digitization\_config}}(i\_cfg.\mbox{\hyperlink{structtraccc_1_1full__tracking__input__config_a9d09f5ae4422abd2074ffbdcd1de81f4}{digitization\_config\_file}});}
\DoxyCodeLine{47 }
\DoxyCodeLine{48     \textcolor{comment}{// Output stats}}
\DoxyCodeLine{49     uint64\_t n\_cells = 0;}
\DoxyCodeLine{50     uint64\_t n\_modules = 0;}
\DoxyCodeLine{51     uint64\_t n\_measurements = 0;}
\DoxyCodeLine{52     uint64\_t n\_spacepoints = 0;}
\DoxyCodeLine{53     uint64\_t n\_seeds = 0;}
\DoxyCodeLine{54 }
\DoxyCodeLine{55     \textcolor{comment}{// Configs}}
\DoxyCodeLine{56     \mbox{\hyperlink{structtraccc_1_1seedfinder__config}{traccc::seedfinder\_config}} finder\_config;}
\DoxyCodeLine{57     \mbox{\hyperlink{structtraccc_1_1spacepoint__grid__config}{traccc::spacepoint\_grid\_config}} grid\_config(finder\_config);}
\DoxyCodeLine{58     \mbox{\hyperlink{structtraccc_1_1seedfilter__config}{traccc::seedfilter\_config}} filter\_config;}
\DoxyCodeLine{59 }
\DoxyCodeLine{60     \textcolor{comment}{// Memory resource used by the EDM.}}
\DoxyCodeLine{61     vecmem::host\_memory\_resource host\_mr;}
\DoxyCodeLine{62 }
\DoxyCodeLine{63     \mbox{\hyperlink{classtraccc_1_1clusterization__algorithm}{traccc::clusterization\_algorithm}} ca(host\_mr);}
\DoxyCodeLine{64     \mbox{\hyperlink{classtraccc_1_1spacepoint__formation}{traccc::spacepoint\_formation}} sf(host\_mr);}
\DoxyCodeLine{65     \mbox{\hyperlink{classtraccc_1_1seeding__algorithm}{traccc::seeding\_algorithm}} sa(finder\_config, grid\_config, filter\_config,}
\DoxyCodeLine{66                                  host\_mr);}
\DoxyCodeLine{67     \mbox{\hyperlink{classtraccc_1_1track__params__estimation}{traccc::track\_params\_estimation}} tp(host\_mr);}
\DoxyCodeLine{68 }
\DoxyCodeLine{69     \textcolor{comment}{// performance writer}}
\DoxyCodeLine{70     \mbox{\hyperlink{classtraccc_1_1seeding__performance__writer}{traccc::seeding\_performance\_writer}} sd\_performance\_writer(}
\DoxyCodeLine{71         \mbox{\hyperlink{structtraccc_1_1seeding__performance__writer_1_1config}{traccc::seeding\_performance\_writer::config}}\{\});}
\DoxyCodeLine{72 }
\DoxyCodeLine{73     \textcolor{comment}{// Loop over events}}
\DoxyCodeLine{74     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}} = common\_opts.\mbox{\hyperlink{structtraccc_1_1common__options_ac0477bdb9a07bf525e12b006e141e094}{skip}};}
\DoxyCodeLine{75          \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}} < common\_opts.\mbox{\hyperlink{structtraccc_1_1common__options_adefc317cdc0b846c7be8db1e5f0c3ef2}{events}} + common\_opts.\mbox{\hyperlink{structtraccc_1_1common__options_ac0477bdb9a07bf525e12b006e141e094}{skip}}; ++\mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}) \{}
\DoxyCodeLine{76 }
\DoxyCodeLine{77         \mbox{\hyperlink{structtraccc_1_1io_1_1cell__reader__output}{traccc::io::cell\_reader\_output}} readOut(\&host\_mr);}
\DoxyCodeLine{78 }
\DoxyCodeLine{79         \textcolor{comment}{// Read the cells from the relevant event file}}
\DoxyCodeLine{80         \mbox{\hyperlink{namespacetraccc_1_1io_a4141a99f877738d68d63f85ed5642462}{traccc::io::read\_cells}}(readOut, \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, common\_opts.\mbox{\hyperlink{structtraccc_1_1common__options_aec17933699762e2feb58124cef53d6b2}{input\_directory}},}
\DoxyCodeLine{81                                common\_opts.\mbox{\hyperlink{structtraccc_1_1common__options_a290ad4675f5a976c73c2a05e35dd1b5c}{input\_data\_format}},}
\DoxyCodeLine{82                                \&surface\_transforms, \&digi\_cfg);}
\DoxyCodeLine{83         \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::cell\_collection\_types::host}}\& cells\_per\_event = readOut.cells;}
\DoxyCodeLine{84         \mbox{\hyperlink{structtraccc_1_1collection__types_ab1b46d2f1f58a16bde873c1aa3f4557d}{traccc::cell\_module\_collection\_types::host}}\& modules\_per\_event =}
\DoxyCodeLine{85             readOut.modules;}
\DoxyCodeLine{86 }
\DoxyCodeLine{87         \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{88 \textcolor{comment}{            Clusterization}}
\DoxyCodeLine{89 \textcolor{comment}{          -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91         \textcolor{keyword}{auto} measurements\_per\_event = ca(cells\_per\_event, modules\_per\_event);}
\DoxyCodeLine{92 }
\DoxyCodeLine{93         \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{94 \textcolor{comment}{            Spacepoint formation}}
\DoxyCodeLine{95 \textcolor{comment}{          -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{96 }
\DoxyCodeLine{97         \textcolor{keyword}{auto} spacepoints\_per\_event =}
\DoxyCodeLine{98             sf(measurements\_per\_event, modules\_per\_event);}
\DoxyCodeLine{99 }
\DoxyCodeLine{100         \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{101 \textcolor{comment}{          Seeding algorithm}}
\DoxyCodeLine{102 \textcolor{comment}{          -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{103 }
\DoxyCodeLine{104         \textcolor{keyword}{auto} seeds = sa(spacepoints\_per\_event);}
\DoxyCodeLine{105 }
\DoxyCodeLine{106         \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{107 \textcolor{comment}{          Track params estimation}}
\DoxyCodeLine{108 \textcolor{comment}{          -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{109 }
\DoxyCodeLine{110         \textcolor{keyword}{auto} params = tp(spacepoints\_per\_event, seeds,}
\DoxyCodeLine{111                          \{0.f, 0.f, finder\_config.\mbox{\hyperlink{structtraccc_1_1seedfinder__config_af3b9be46bd90bb968da94db6ac36bd45}{bFieldInZ}}\});}
\DoxyCodeLine{112 }
\DoxyCodeLine{113         \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{114 \textcolor{comment}{          Statistics}}
\DoxyCodeLine{115 \textcolor{comment}{          -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{116 }
\DoxyCodeLine{117         n\_modules += modules\_per\_event.size();}
\DoxyCodeLine{118         n\_cells += cells\_per\_event.size();}
\DoxyCodeLine{119         n\_measurements += measurements\_per\_event.size();}
\DoxyCodeLine{120         n\_spacepoints += spacepoints\_per\_event.size();}
\DoxyCodeLine{121         n\_seeds += seeds.size();}
\DoxyCodeLine{122 }
\DoxyCodeLine{123         \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{124 \textcolor{comment}{             Writer}}
\DoxyCodeLine{125 \textcolor{comment}{          -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{126 }
\DoxyCodeLine{127         \textcolor{keywordflow}{if} (common\_opts.\mbox{\hyperlink{structtraccc_1_1common__options_a06a875a852f866c6ad5abfaae82cb440}{check\_performance}}) \{}
\DoxyCodeLine{128             \mbox{\hyperlink{structtraccc_1_1event__map}{traccc::event\_map}} evt\_map(}
\DoxyCodeLine{129                 \mbox{\hyperlink{test__mapper_8cpp_aa79e3eff1ed8e629ebc8e3268c4805f9}{event}}, det\_opts.\mbox{\hyperlink{structtraccc_1_1detector__input__options_a1121f57fa16a57c9d2cef56f94390bcb}{detector\_file}}, i\_cfg.\mbox{\hyperlink{structtraccc_1_1full__tracking__input__config_a9d09f5ae4422abd2074ffbdcd1de81f4}{digitization\_config\_file}},}
\DoxyCodeLine{130                 common\_opts.\mbox{\hyperlink{structtraccc_1_1common__options_aec17933699762e2feb58124cef53d6b2}{input\_directory}}, common\_opts.\mbox{\hyperlink{structtraccc_1_1common__options_aec17933699762e2feb58124cef53d6b2}{input\_directory}},}
\DoxyCodeLine{131                 common\_opts.\mbox{\hyperlink{structtraccc_1_1common__options_aec17933699762e2feb58124cef53d6b2}{input\_directory}}, host\_mr);}
\DoxyCodeLine{132 }
\DoxyCodeLine{133             sd\_performance\_writer.write(\mbox{\hyperlink{namespacetraccc_a503d2d50b981602cbc71693ad215b298}{vecmem::get\_data}}(seeds),}
\DoxyCodeLine{134                                         \mbox{\hyperlink{namespacetraccc_a503d2d50b981602cbc71693ad215b298}{vecmem::get\_data}}(spacepoints\_per\_event),}
\DoxyCodeLine{135                                         evt\_map);}
\DoxyCodeLine{136         \}}
\DoxyCodeLine{137     \}}
\DoxyCodeLine{138 }
\DoxyCodeLine{139     \textcolor{keywordflow}{if} (common\_opts.\mbox{\hyperlink{structtraccc_1_1common__options_a06a875a852f866c6ad5abfaae82cb440}{check\_performance}}) \{}
\DoxyCodeLine{140         sd\_performance\_writer.finalize();}
\DoxyCodeLine{141     \}}
\DoxyCodeLine{142 }
\DoxyCodeLine{143     std::cout << \textcolor{stringliteral}{"==> Statistics ... "} << std::endl;}
\DoxyCodeLine{144     std::cout << \textcolor{stringliteral}{"-\/ read    "} << n\_cells << \textcolor{stringliteral}{" cells from "} << n\_modules}
\DoxyCodeLine{145               << \textcolor{stringliteral}{" modules"} << std::endl;}
\DoxyCodeLine{146     std::cout << \textcolor{stringliteral}{"-\/ created "} << n\_measurements << \textcolor{stringliteral}{" measurements. "}}
\DoxyCodeLine{147               << std::endl;}
\DoxyCodeLine{148     std::cout << \textcolor{stringliteral}{"-\/ created "} << n\_spacepoints << \textcolor{stringliteral}{" space points. "}}
\DoxyCodeLine{149               << std::endl;}
\DoxyCodeLine{150     std::cout << \textcolor{stringliteral}{"-\/ created "} << n\_seeds << \textcolor{stringliteral}{" seeds"} << std::endl;}
\DoxyCodeLine{151 }
\DoxyCodeLine{152     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{153 \}}

\end{DoxyCode}


References traccc\+::seedfinder\+\_\+config\+::b\+Field\+InZ, traccc\+::io\+::cell\+\_\+reader\+\_\+output\+::cells, traccc\+::common\+\_\+options\+::check\+\_\+performance, traccc\+::detector\+\_\+input\+\_\+options\+::detector\+\_\+file, traccc\+::full\+\_\+tracking\+\_\+input\+\_\+config\+::digitization\+\_\+config\+\_\+file, event, traccc\+::common\+\_\+options\+::events, traccc\+::get\+\_\+data(), traccc\+::common\+\_\+options\+::input\+\_\+data\+\_\+format, traccc\+::common\+\_\+options\+::input\+\_\+directory, traccc\+::io\+::cell\+\_\+reader\+\_\+output\+::modules, traccc\+::io\+::read\+\_\+cells(), traccc\+::io\+::read\+\_\+digitization\+\_\+config(), traccc\+::io\+::read\+\_\+geometry(), and traccc\+::common\+\_\+options\+::skip.



Referenced by main().

