<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>traccc: traccc</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">traccc
   &#160;<span id="projectnumber">02</span>
   </div>
   <div id="projectbrief">&#39;tracccisapartofactsprojectatcern.Itisfocusedtowardsthetrackreconstructionoftheparticles&#39;</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">traccc </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Demonstrator tracking chain for accelerators.</p>
<h1><a class="anchor" id="autotoc_md15"></a>
Features</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Category </th><th class="markdownTableHeadNone">Algorithms </th><th class="markdownTableHeadNone">CPU </th><th class="markdownTableHeadNone">CUDA </th><th class="markdownTableHeadNone">SYCL </th><th class="markdownTableHeadNone">Futhark  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Clusterization</b> </td><td class="markdownTableBodyNone">CCL </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ…  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Measurement creation </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ…  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Seeding</b> </td><td class="markdownTableBodyNone">Spacepoint formation </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âšª  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Spacepoint binning </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âšª  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Seed finding </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âšª  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Track param estimation </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âšª  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Track finding</b> </td><td class="markdownTableBodyNone">Combinatorial KF </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">ðŸŸ¡ </td><td class="markdownTableBodyNone">âšª  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Track fitting</b> </td><td class="markdownTableBodyNone">KF </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âšª  </td></tr>
</table>
<p>âœ…: exists, ðŸŸ¡: work started, âšª: work not started yet</p>
<p>The relations between datatypes and algorithms is given in the (approximately commutative) diagram shown below. Black lines indicate CPU algorithms, green lines indicate CUDA algorithms, blue lines indicate SYCL algorithms, and brown lines indicate Futhark algorithms. Solid algorithms are ready for use, dashed algorithms are in development or future goals. Data types for different heterogeneous platforms are contracted for legibility, and identities are hidden.</p>
<div class="fragment"><div class="line">flowchart LR</div>
<div class="line">    subgraph clusterization [&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/core/include/traccc/clusterization/clusterization_algorithm.hpp&#39;&gt;Clusterization&lt;/a&gt;]</div>
<div class="line">        direction TB</div>
<div class="line">        cell(Cells);</div>
<div class="line">        cluster(Clusters);</div>
<div class="line">        meas(Measurements);</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph trkfinding [Track Finding]</div>
<div class="line">        sp(Spacepoints);</div>
<div class="line">        bin(Bins);</div>
<div class="line">        seed(Seeds);</div>
<div class="line">        ptrack(Prototracks);</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph trkfitting [Track Fitting]</div>
<div class="line">        track(Track);</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    click cell href &quot;https://github.com/acts-project/traccc/blob/main/core/include/traccc/edm/cell.hpp&quot;;</div>
<div class="line">    click cluster href &quot;https://github.com/acts-project/traccc/blob/main/core/include/traccc/edm/cluster.hpp&quot;;</div>
<div class="line">    click meas href &quot;https://github.com/acts-project/traccc/blob/main/core/include/traccc/edm/measurement.hpp&quot;;</div>
<div class="line">    click sp href &quot;https://github.com/acts-project/traccc/blob/main/core/include/traccc/edm/spacepoint.hpp&quot;;</div>
<div class="line">    click seed href &quot;https://github.com/acts-project/traccc/blob/main/core/include/traccc/edm/seed.hpp&quot;;</div>
<div class="line">    click ptrack href &quot;https://github.com/acts-project/traccc/blob/main/core/include/traccc/edm/track_parameters.hpp&quot;;</div>
<div class="line"> </div>
<div class="line">    %% CPU CCL algorithm</div>
<div class="line">    cell --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/core/include/traccc/clusterization/component_connection.hpp&#39;&gt;CCL&lt;/a&gt;| cluster;</div>
<div class="line">    linkStyle 0 stroke: black;</div>
<div class="line"> </div>
<div class="line">    %% SYCL CCL algorithm</div>
<div class="line">    cell --&gt;|CCL| cluster;</div>
<div class="line">    linkStyle 1 stroke: blue;</div>
<div class="line"> </div>
<div class="line">    %% CUDA CCL algorithm</div>
<div class="line">    cell --&gt;|CCL| cluster;</div>
<div class="line">    linkStyle 2 stroke: green;</div>
<div class="line"> </div>
<div class="line">    %% CPU clusterization</div>
<div class="line">    cluster --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/core/include/traccc/clusterization/measurement_creation.hpp&#39;&gt;Agg.&lt;/a&gt;| meas;</div>
<div class="line">    linkStyle 3 stroke: black;</div>
<div class="line"> </div>
<div class="line">    %% SYCL clusterization</div>
<div class="line">    cluster --&gt;|Agg.| meas;</div>
<div class="line">    linkStyle 4 stroke: blue;</div>
<div class="line"> </div>
<div class="line">    %% CUDA clusterization</div>
<div class="line">    cluster --&gt;|Agg.| meas;</div>
<div class="line">    linkStyle 5 stroke: green;</div>
<div class="line"> </div>
<div class="line">    %% CUDA CCA</div>
<div class="line">    cell --&gt;|CCA| meas;</div>
<div class="line">    linkStyle 6 stroke: green;</div>
<div class="line"> </div>
<div class="line">    %% CPU local to global</div>
<div class="line">    meas --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/core/include/traccc/clusterization/spacepoint_formation.hpp&#39;&gt;L2G&lt;/a&gt;| sp;</div>
<div class="line">    linkStyle 7 stroke: black;</div>
<div class="line"> </div>
<div class="line">    %% SYCL local to global</div>
<div class="line">    meas --&gt;|L2G| sp;</div>
<div class="line">    linkStyle 8 stroke: blue;</div>
<div class="line"> </div>
<div class="line">    %% CUDA local to global</div>
<div class="line">    meas --&gt;|L2G| sp;</div>
<div class="line">    linkStyle 9 stroke: green;</div>
<div class="line"> </div>
<div class="line">    %% CPU binning</div>
<div class="line">    sp --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/core/include/traccc/seeding/spacepoint_binning.hpp&#39;&gt;Binning&lt;/a&gt;| bin;</div>
<div class="line">    linkStyle 10 stroke: black;</div>
<div class="line"> </div>
<div class="line">    %% CUDA binning</div>
<div class="line">    sp --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/device/cuda/include/traccc/cuda/seeding/spacepoint_binning.hpp&#39;&gt;Binning&lt;/a&gt;| bin;</div>
<div class="line">    linkStyle 11 stroke: green;</div>
<div class="line"> </div>
<div class="line">    %% CPU seeding</div>
<div class="line">    bin --&gt;|Seeding| seed;</div>
<div class="line">    linkStyle 12 stroke: black;</div>
<div class="line"> </div>
<div class="line">    %% SYCL seeding</div>
<div class="line">    bin --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/device/sycl/include/traccc/sycl/seeding/seed_finding.hpp&#39;&gt;Seeding&lt;/a&gt;| seed;</div>
<div class="line">    linkStyle 13 stroke: blue;</div>
<div class="line"> </div>
<div class="line">    %% CUDA seeding</div>
<div class="line">    bin --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/tree/main/device/cuda/include/traccc/cuda/seeding&#39;&gt;Seeding&lt;/a&gt;| seed;</div>
<div class="line">    linkStyle 14 stroke: green;</div>
<div class="line"> </div>
<div class="line">    %% CUDA binless seeding</div>
<div class="line">    sp -.-&gt;|Seeding| seed;</div>
<div class="line">    linkStyle 15 stroke: green;</div>
<div class="line"> </div>
<div class="line">    %% CPU param est.</div>
<div class="line">    seed --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/core/include/traccc/seeding/track_params_estimation.hpp&#39;&gt;Param. Est.&lt;/a&gt;| ptrack;</div>
<div class="line">    linkStyle 16 stroke: black;</div>
<div class="line"> </div>
<div class="line">    %% CUDA param est.</div>
<div class="line">    seed --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/device/cuda/include/traccc/cuda/seeding/track_params_estimation.hpp&#39;&gt;Param. Est.&lt;/a&gt;| ptrack;</div>
<div class="line">    linkStyle 17 stroke: green;</div>
<div class="line"> </div>
<div class="line">    %% CPU CKF</div>
<div class="line">    ptrack -.-&gt;|CKF| track;</div>
<div class="line">    linkStyle 18 stroke: black;</div>
<div class="line"> </div>
<div class="line">    %% CPU Kalman filter</div>
<div class="line">    track --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/core/include/traccc/fitting/fitting_algorithm.hpp&#39;&gt;Kalman filter&lt;/a&gt;| track;</div>
<div class="line">    linkStyle 19 stroke: black;</div>
<div class="line"> </div>
<div class="line">    %% CUDA Kalman filter</div>
<div class="line">    track --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/device/cuda/include/traccc/cuda/fitting/fitting_algorithm.hpp&#39;&gt;Kalman filter&lt;/a&gt;| track;</div>
<div class="line">    linkStyle 20 stroke: green;</div>
<div class="line"> </div>
<div class="line">    %% SYCL binning</div>
<div class="line">    sp --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/device/sycl/include/traccc/sycl/seeding/spacepoint_binning.hpp&#39;&gt;Binning&lt;/a&gt;| bin;</div>
<div class="line">    linkStyle 21 stroke: blue;</div>
<div class="line"> </div>
<div class="line">    %% SYCL track parameter est.</div>
<div class="line">    seed --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/device/sycl/include/traccc/sycl/seeding/track_params_estimation.hpp&#39;&gt;Param. Est.&lt;/a&gt;| ptrack;</div>
<div class="line">    linkStyle 22 stroke: blue;</div>
<div class="line"> </div>
<div class="line">    %% Futhark measurement creation</div>
<div class="line">    cell --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/device/futhark/src/measurement_creation.fut&#39;&gt;CCA&lt;/a&gt;| meas;</div>
<div class="line">    linkStyle 23 stroke: brown;</div>
<div class="line"> </div>
<div class="line">    %% Futhark spacepoint creation</div>
<div class="line">    meas --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/device/futhark/src/spacepoint_formation.fut&#39;&gt;L2G&lt;/a&gt;| sp;</div>
<div class="line">    linkStyle 24 stroke: brown;</div>
<div class="line"> </div>
<div class="line">    %% SYCL Kalman filter</div>
<div class="line">    track --&gt;|&lt;a href=&#39;https://github.com/acts-project/traccc/blob/main/device/sycl/include/traccc/sycl/fitting/fitting_algorithm.hpp&#39;&gt;Kalman filter&lt;/a&gt;| track;</div>
<div class="line">    linkStyle 25 stroke: blue;</div>
<div class="line"> </div>
<div class="line">    %% CUDA CKF</div>
<div class="line">    ptrack -.-&gt;|CKF| track;</div>
<div class="line">    linkStyle 26 stroke: green;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md16"></a>
Requirements and dependencies</h1>
<h2><a class="anchor" id="autotoc_md17"></a>
OS &amp; compilers:</h2>
<p>Please note that due to the complexity of this software and its build system, it may be somewhat fragile in the face of compiler version changes. The following are general guidelines for getting <em>traccc</em> to compile:</p>
<ul>
<li>The C++ compiler must support C++17</li>
</ul>
<p>In addition, the following requirements hold when CUDA is enabled:</p>
<ul>
<li>The CUDA Toolkit version must be greater than major version 11</li>
<li>The CUDA Toolkit must not be minor version 11.3 due to a <a href="https://github.com/acts-project/traccc/issues/115">bug</a> in the front-end compiler of that version</li>
<li>Ensure that the CUDA host compiler supports C++17 and is compatible with the <code>nvcc</code> compiler driver</li>
</ul>
<p>The following table lists currently combinations of builds, compilers, and toolchains that are currently known to work (last updated 2022/01/24):</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Build </th><th class="markdownTableHeadNone">OS </th><th class="markdownTableHeadNone">gcc </th><th class="markdownTableHeadNone">CUDA </th><th class="markdownTableHeadNone">comment  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CUDA </td><td class="markdownTableBodyNone">Ubuntu 20.04 </td><td class="markdownTableBodyNone">9.3.0 </td><td class="markdownTableBodyNone">11.5 </td><td class="markdownTableBodyNone">runs on CI  </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md18"></a>
Dependencies</h2>
<ul>
<li><a href="https://www.boost.org/">Boost</a>: program_options</li>
<li><a href="https://cmake.org/">CMake</a></li>
<li>(Optional) <a href="https://root.cern/">ROOT</a>: RIO, Hist, Tree</li>
</ul>
<h1><a class="anchor" id="autotoc_md19"></a>
Getting started</h1>
<h2><a class="anchor" id="autotoc_md20"></a>
Clone the repository</h2>
<p>Clone the repository and setup the data directory.</p>
<div class="fragment"><div class="line">git clone git@github.com:acts-project/traccc.git</div>
<div class="line">cd traccc</div>
<div class="line">./data/traccc_data_get_files.sh</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md21"></a>
Build the project</h2>
<div class="fragment"><div class="line">cmake -S . -B &lt;build_directory&gt;</div>
<div class="line">cmake --build &lt;build_directory&gt; &lt;options&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md22"></a>
Build options</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TRACCC_BUILD_CUDA </td><td class="markdownTableBodyNone">Build the CUDA sources included in traccc  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TRACCC_BUILD_SYCL </td><td class="markdownTableBodyNone">Build the SYCL sources included in traccc  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TRACCC_BUILD_TESTING </td><td class="markdownTableBodyNone">Build the (unit) tests of traccc  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TRACCC_BUILD_EXAMPLES </td><td class="markdownTableBodyNone">Build the examples of traccc  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TRACCC_USE_SYSTEM_VECMEM </td><td class="markdownTableBodyNone">Pick up an existing installation of VecMem from the build environment  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TRACCC_USE_SYSTEM_EIGEN3 </td><td class="markdownTableBodyNone">Pick up an existing installation of Eigen3 from the build environment  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TRACCC_USE_SYSTEM_ALGEBRA_PLUGINS </td><td class="markdownTableBodyNone">Pick up an existing installation of Algebra Plugins from the build environment  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TRACCC_USE_SYSTEM_DFELIBS </td><td class="markdownTableBodyNone">Pick up an existing installation of dfelibs from the build environment  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TRACCC_USE_SYSTEM_DETRAY </td><td class="markdownTableBodyNone">Pick up an existing installation of Detray from the build environment  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TRACCC_USE_SYSTEM_ACTS </td><td class="markdownTableBodyNone">Pick up an existing installation of <a class="el" href="../../da/d7b/namespaceActs.html">Acts</a> from the build environment  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TRACCC_USE_SYSTEM_GOOGLETEST </td><td class="markdownTableBodyNone">Pick up an existing installation of GoogleTest from the build environment  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TRACCC_USE_ROOT </td><td class="markdownTableBodyNone">Build physics performance analysis code using an existing installation of ROOT from the build environment  </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md23"></a>
Examples</h1>
<h2><a class="anchor" id="autotoc_md24"></a>
CPU reconstruction chain</h2>
<div class="fragment"><div class="line">&lt;build_directory&gt;/bin/traccc_seq_example --detector_file=tml_detector/trackml-detector.csv --digitization_config_file=tml_detector/default-geometric-config-generic.json --input_directory=tml_pixels/ --events=10</div>
<div class="line"> </div>
<div class="line">&lt;build_directory&gt;/bin/traccc_throughput_mt --detector_file=tml_detector/trackml-detector.csv --digitization_config_file=tml_detector/default-geometric-config-generic.json --input_directory=tml_pixels/  --cold_run_events=100 --processed_events=1000 --threads=1</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md25"></a>
CUDA reconstruction chain</h2>
<ul>
<li>Users can generate CUDA examples by adding <code>-DTRACCC_BUILD_CUDA=ON</code> to cmake options</li>
</ul>
<div class="fragment"><div class="line">&lt;build_directory&gt;/bin/traccc_seq_example_cuda --detector_file=tml_detector/trackml-detector.csv --digitization_config_file=tml_detector/default-geometric-config-generic.json --input_directory=tml_pixels/ --events=10 --run_cpu=1</div>
<div class="line"> </div>
<div class="line">&lt;build_directory&gt;/bin/traccc_throughput_mt_cuda --detector_file=tml_detector/trackml-detector.csv --digitization_config_file=tml_detector/default-geometric-config-generic.json --input_directory=tml_pixels/  --cold_run_events=100 --processed_events=1000 --threads=1</div>
</div><!-- fragment --><div class="fragment"><div class="line"># Toy geometry examples</div>
<div class="line">&lt;build_directory&gt;/bin/traccc_simulate_toy_detector --gen-vertex-xyz-mm=0:0:0 --gen-vertex-xyz-std-mm=0:0:0 --gen-mom-gev=100:100 --gen-phi-degree=0:360 --events=10 --gen-nparticles=2000 --output_directory=detray_simulation/toy_detector/n_particles_2000/ --gen-eta=-3:3 --constraint-step-size-mm=1</div>
<div class="line"> </div>
<div class="line">&lt;build_directory&gt;/bin/traccc_seeding_example_cuda --input_directory=detray_simulation/toy_detector/n_particles_2000/ --check_performance=true --detector_file=&lt;detector_directory&gt;/toy_detector_geometry.json --material_file=&lt;detector_directory&gt;/toy_detector_homogeneous_material.json --grid_file=&lt;detector_directory&gt;/toy_detector_surface_grids.json --event=1 --track_candidates_range=3:30 --constraint-step-size-mm=1000 --run_cpu=1</div>
<div class="line"> </div>
<div class="line">&lt;build_directory&gt;/bin/traccc_truth_finding_example_cuda --input_directory=detray_simulation/toy_detector/n_particles_2000/ --check_performance=true --detector_file=&lt;detector_directory&gt;/toy_detector_geometry.json --material_file=&lt;detector_directory&gt;/toy_detector_homogeneous_material.json --grid_file=&lt;detector_directory&gt;/toy_detector_surface_grids.json --event=1 --track_candidates_range=3:30 --constraint-step-size-mm=1 --run_cpu=1</div>
</div><!-- fragment --><div class="fragment"><div class="line"># Wire chamber examples</div>
<div class="line">&lt;build_directory&gt;/bin/traccc_simulate_wire_chamber --gen-vertex-xyz-mm=0:0:0 --gen-vertex-xyz-std-mm=0:0:0 --gen-mom-gev=2:2 --gen-phi-degree=0:360 --events=10 --gen-nparticles=1000 --output_directory=detray_simulation/wire_chamber/n_particles_1000/ --gen-eta=-1:1 --constraint-step-size-mm=1</div>
<div class="line"> </div>
<div class="line">&lt;build_directory&gt;/bin/traccc_truth_finding_example_cuda --input_directory=detray_simulation/wire_chamber/n_particles_1000/ --check_performance=true --detector_file=&lt;detector_directory&gt;/wire_chamber_geometry.json --material_file=&lt;detector_directory&gt;/wire_chamber_homogeneous_material.json --grid_file=&lt;detector_directory&gt;/wire_chamber_surface_grids.json  --event=10 --track_candidates_range=6:30 --constraint-step-size-mm=1</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md26"></a>
SYCL reconstruction chain</h2>
<ul>
<li>Users can generate SYCL examples by adding <code>-DTRACCC_BUILD_SYCL=ON</code> to cmake options</li>
</ul>
<div class="fragment"><div class="line">&lt;build_directory&gt;/bin/traccc_seq_example_sycl --detector_file=tml_detector/trackml-detector.csv --digitization_config_file=tml_detector/default-geometric-config-generic.json --input_directory=tml_pixels/ --events=10 --run_cpu=1</div>
<div class="line"> </div>
<div class="line">&lt;build_directory&gt;/bin/traccc_throughput_mt_sycl --detector_file=tml_detector/trackml-detector.csv --digitization_config_file=tml_detector/default-geometric-config-generic.json --input_directory=tml_pixels/  --cold_run_events=100 --processed_events=1000 --threads=1</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md27"></a>
Running a partial chain with simplified simulation data</h2>
<p>Users can generate muon-like particle simulation data with the pre-built detray geometries:</p>
<div class="fragment"><div class="line"># Generate telescope geometry data</div>
<div class="line">&lt;build_directory&gt;/bin/traccc_simulate_telescope --gen-vertex-xyz-mm=0:0:0 --gen-vertex-xyz-std-mm=0:0:0 --gen-mom-gev=100:100 --gen-phi-degree=0:0 --events=10 --gen-nparticles=2000 --output_directory=detray_simulation/telescope_detector/n_particles_2000/ --gen-eta=1:3 </div>
<div class="line"> </div>
<div class="line"># Generate toy geometry data</div>
<div class="line">&lt;build_directory&gt;/bin/traccc_simulate_toy_detector --gen-vertex-xyz-mm=0:0:0 --gen-vertex-xyz-std-mm=0:0:0 --gen-mom-gev=100:100 --gen-phi-degree=0:360 --events=10 --gen-nparticles=2000 --output_directory=detray_simulation/toy_detector/n_particles_2000/ --gen-eta=-3:3 --constraint-step-size-mm=1</div>
<div class="line"> </div>
<div class="line"># Generate drift chamber data</div>
<div class="line">&lt;build_directory&gt;/bin/traccc_simulate_wire_chamber --gen-vertex-xyz-mm=0:0:0 --gen-vertex-xyz-std-mm=0:0:0 --gen-mom-gev=2:2 --gen-phi-degree=0:360 --events=10 --gen-nparticles=100 --output_directory=detray_simulation/wire_chamber/n_particles_100/ --gen-eta=-1:1 --constraint-step-size-mm=1</div>
</div><!-- fragment --><p>The simulation will also generate the detector json files (geometry, material and surface_grid) in the current directory. It is user's responsibility to move them to an appropriate place (e.g. <code>&lt;detector_directory&gt;</code>) and match them to the input file arguments of reconstruction chains.</p>
<p>If users have a geometry json file already, it is also possible to run simulation with <code>traccc_simulate</code> application</p>
<div class="fragment"><div class="line"># Given that users have a geometry json file</div>
<div class="line">&lt;build_directory&gt;/bin/traccc_simulate  --output_directory=&lt;output_directory&gt;  --detector_file=&lt;geometry_file&gt; --material_file=&lt;material_file&gt; --grid_file=&lt;grid_file&gt;  --event=10 --constraint-step-size-mm=1</div>
</div><!-- fragment --><p>There are three types of partial reconstruction chain users can operate: <code>seeding_example</code>, <code>truth_finding_example</code>, and <code>truth_fitting_example</code> where their algorithm coverages are shown in the table below. Each of them starts from truth measurements, truth seeds, and truth tracks, respectively.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Category </th><th class="markdownTableHeadNone">Clusterization </th><th class="markdownTableHeadNone">Seeding </th><th class="markdownTableHeadNone">Track finding </th><th class="markdownTableHeadNone">Track fitting  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>seeding_example</code> </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ…  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>truth_finding_example</code> </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">âœ… </td><td class="markdownTableBodyNone">âœ…  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>truth_fitting_example</code> </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">âœ…  </td></tr>
</table>
<p>The dirft chamber will not produce meaningful results with <code>seeding_example</code> as the current seeding algorithm is only designed for 2D measurement objects. Truth finding works OK in general but the combinatoric explosion can occur for a few unlucky events, leading to poor pull value distributions. The followings are example commands:</p>
<div class="fragment"><div class="line"># Run cuda seeding example for toy geometry</div>
<div class="line">&lt;build_directory&gt;/bin/traccc_seeding_example_cuda --input_directory=detray_simulation/toy_detector/n_particles_2000/ --check_performance=true --detector_file=&lt;detector_directory&gt;/toy_detector_geometry.json --material_file=&lt;detector_directory&gt;/toy_detector_homogeneous_material.json --grid_file=&lt;detector_directory&gt;/toy_detector_surface_grids.json --event=1 --track_candidates_range=3:30 --constraint-step-size-mm=1000 --run_cpu=1</div>
</div><!-- fragment --><div class="fragment"><div class="line"># Run cuda truth finding example for toy geometry</div>
<div class="line">&lt;build_directory&gt;/bin/traccc_truth_finding_example_cuda --input_directory=detray_simulation/toy_detector/n_particles_2000/ --check_performance=true --detector_file=&lt;detector_directory&gt;/toy_detector_geometry.json --material_file=&lt;detector_directory&gt;/toy_detector_homogeneous_material.json --grid_file=&lt;detector_directory&gt;/toy_detector_surface_grids.json --event=1 --track_candidates_range=3:30 --constraint-step-size-mm=1000 --run_cpu=1</div>
</div><!-- fragment --><div class="fragment"><div class="line"># Run cuda truth finding example for drift chamber</div>
<div class="line">&lt;build_directory&gt;/bin/traccc_truth_finding_example_cuda --input_directory=detray_simulation/wire_chamber/n_particles_100/ --check_performance=true --detector_file=&lt;detector_directory&gt;/wire_chamber_geometry.json --material_file=&lt;detector_directory&gt;/wire_chamber_homogeneous_material.json --grid_file=&lt;detector_directory&gt;/wire_chamber_surface_grids.json  --event=10 --track_candidates_range=6:30 --constraint-step-size-mm=1 --run_cpu=1</div>
</div><!-- fragment --><div class="fragment"><div class="line"># Run cpu truth fitting example for drift chamber</div>
<div class="line">&lt;build_directory&gt;/bin/traccc_truth_fitting_example --input_directory=detray_simulation/wire_chamber/n_particles_2000_100GeV/ --check_performance=true --detector_file=&lt;detector_directory&gt;/wire_chamber_geometry.json --material_file=&lt;detector_directory&gt;/wire_chamber_homogeneous_material.json --grid_file=&lt;detector_directory&gt;/wire_chamber_surface_grids.json --event=10 --constraint-step-size-mm=1</div>
</div><!-- fragment --><p>Users can open the performance root files (with <code>--check_performance=true</code>) and draw the histograms.</p>
<div class="fragment"><div class="line">$ root -l performance_track_finding.root </div>
<div class="line">root [0] </div>
<div class="line">Attaching file performance_track_finding.root as _file0...</div>
<div class="line">(TFile *) 0x3871910</div>
<div class="line">root [1] finding_trackeff_vs_eta-&gt;Draw()</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md28"></a>
Troubleshooting</h1>
<p>The following are potentially useful instructions for troubleshooting various problems with your build:</p>
<h2><a class="anchor" id="autotoc_md29"></a>
CUDA</h2>
<h3><a class="anchor" id="autotoc_md30"></a>
Incompatible host compiler</h3>
<p>You may experience errors being issued about standard library features, for example:</p>
<div class="fragment"><div class="line">/usr/include/c++/11/bits/std_function.h:435:145: note:         â€˜_ArgTypesâ€™</div>
<div class="line">/usr/include/c++/11/bits/std_function.h:530:146: error: parameter packs not expanded with â€˜...â€™:</div>
<div class="line">  530 |         operator=(_Functor&amp;&amp; __f)</div>
</div><!-- fragment --><p>In this case, your <code>nvcc</code> host compiler is most likely incompatible with your CUDA toolkit. Consider installing a supported version and selecting it through the <code>CUDAHOSTCXX</code> environment variable at build-time. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
